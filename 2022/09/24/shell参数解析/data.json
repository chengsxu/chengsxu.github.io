{"title":"shell参数解析","date":"2022-09-24T00:29:49.074Z","source":"_posts/shell参数解析.md","raw":"---\ntitle: shell参数解析\ndate: 2022-09-24 08:29:49.074\nupdated: 2022-09-24 08:48:19.756\ncategories: \ntags: \n- linux\n---\nshell参数解析\n<!-- more -->\n## 简单解析\n\n| 参数 | 作用      |\n| ---- | --------- |\n| $@   | 全部参数  |\n| $*   | 全部参数  |\n| $#   | 参数个数  |\n| $n   | 第n个参数 |\n\n```\n$@和$*存在一定区别，当两者在\"\"中充当参数时，$@不会对所有参数进行处理；$*会把所有参数合并成一个参数处理\n```\n\n## getopt 短参数\n```shell\n#!/bin/bash\n# test.sh\nwhile getopts \":a:b\" opt\ndo\n  case $opt in\n    a)\n      a=$OPTARG\n      echo \"a is $a\";;\n    b)\n      echo \"b is set\";;\n    ?)\n      echo \"getopts param error\"\n      exit 1;;\n  esac\ndone\n\n# ./test.sh -b -a 8\n\":a:b\"\n最前面的引号：忽略执行错误\na后面引号：表示该标志后有参数\nb无引号：表示该标志后无参数\n```\n## getopts 长参数\n```\n#!/bin/bash\n\n# Setup getopt.\nlong_opts=\"debug,arg:\"\ngetopt_cmd=$(getopt -o da: --long \"$long_opts\" \\\n            -n $(basename $0) -- \"$@\") || \\\n            { echo -e \"\\nERROR: Getopt failed. Extra args\\n\"; exit 1;}\n\neval set -- \"$getopt_cmd\"\nwhile true; do\n    case \"$1\" in\n        -d|--debug) echo \"debug is true\";;\n        -a|--arg) echo \"arg is $2\";;\n        --) shift; break;;\n    esac\n    shift\ndone\n```\n\n\n","slug":"shell参数解析","published":true,"updated":"2022-09-24T00:48:19.756Z","_id":"cm833960z001ki0q674dh389q","comments":true,"layout":"post","photos":[],"html":"<p>shell参数解析</p>\n<span id=\"more\"></span>\n<h2 id=\"简单解析\"><a href=\"#简单解析\" class=\"headerlink\" title=\"简单解析\"></a>简单解析</h2><table>\n<thead>\n<tr>\n<th>参数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>$@</td>\n<td>全部参数</td>\n</tr>\n<tr>\n<td>$*</td>\n<td>全部参数</td>\n</tr>\n<tr>\n<td>$#</td>\n<td>参数个数</td>\n</tr>\n<tr>\n<td>$n</td>\n<td>第n个参数</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$@和$*存在一定区别，当两者在&quot;&quot;中充当参数时，$@不会对所有参数进行处理；$*会把所有参数合并成一个参数处理</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getopt-短参数\"><a href=\"#getopt-短参数\" class=\"headerlink\" title=\"getopt 短参数\"></a>getopt 短参数</h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">!/bin/bash</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">test.sh</span></span><br><span class=\"line\">while getopts &quot;:a:b&quot; opt</span><br><span class=\"line\">do</span><br><span class=\"line\">  case $opt in</span><br><span class=\"line\">    a)</span><br><span class=\"line\">      a=$OPTARG</span><br><span class=\"line\">      echo &quot;a is $a&quot;;;</span><br><span class=\"line\">    b)</span><br><span class=\"line\">      echo &quot;b is set&quot;;;</span><br><span class=\"line\">    ?)</span><br><span class=\"line\">      echo &quot;getopts param error&quot;</span><br><span class=\"line\">      exit 1;;</span><br><span class=\"line\">  esac</span><br><span class=\"line\">done</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">./test.sh -b -a 8</span></span><br><span class=\"line\">&quot;:a:b&quot;</span><br><span class=\"line\">最前面的引号：忽略执行错误</span><br><span class=\"line\">a后面引号：表示该标志后有参数</span><br><span class=\"line\">b无引号：表示该标志后无参数</span><br></pre></td></tr></table></figure>\n<h2 id=\"getopts-长参数\"><a href=\"#getopts-长参数\" class=\"headerlink\" title=\"getopts 长参数\"></a>getopts 长参数</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\"></span><br><span class=\"line\"># Setup getopt.</span><br><span class=\"line\">long_opts=&quot;debug,arg:&quot;</span><br><span class=\"line\">getopt_cmd=$(getopt -o da: --long &quot;$long_opts&quot; \\</span><br><span class=\"line\">            -n $(basename $0) -- &quot;$@&quot;) || \\</span><br><span class=\"line\">            &#123; echo -e &quot;\\nERROR: Getopt failed. Extra args\\n&quot;; exit 1;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">eval set -- &quot;$getopt_cmd&quot;</span><br><span class=\"line\">while true; do</span><br><span class=\"line\">    case &quot;$1&quot; in</span><br><span class=\"line\">        -d|--debug) echo &quot;debug is true&quot;;;</span><br><span class=\"line\">        -a|--arg) echo &quot;arg is $2&quot;;;</span><br><span class=\"line\">        --) shift; break;;</span><br><span class=\"line\">    esac</span><br><span class=\"line\">    shift</span><br><span class=\"line\">done</span><br></pre></td></tr></table></figure>\n\n\n","excerpt":"<p>shell参数解析</p>","more":"<h2 id=\"简单解析\"><a href=\"#简单解析\" class=\"headerlink\" title=\"简单解析\"></a>简单解析</h2><table>\n<thead>\n<tr>\n<th>参数</th>\n<th>作用</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>$@</td>\n<td>全部参数</td>\n</tr>\n<tr>\n<td>$*</td>\n<td>全部参数</td>\n</tr>\n<tr>\n<td>$#</td>\n<td>参数个数</td>\n</tr>\n<tr>\n<td>$n</td>\n<td>第n个参数</td>\n</tr>\n</tbody></table>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$@和$*存在一定区别，当两者在&quot;&quot;中充当参数时，$@不会对所有参数进行处理；$*会把所有参数合并成一个参数处理</span><br></pre></td></tr></table></figure>\n\n<h2 id=\"getopt-短参数\"><a href=\"#getopt-短参数\" class=\"headerlink\" title=\"getopt 短参数\"></a>getopt 短参数</h2><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta prompt_\">#</span><span class=\"language-bash\">!/bin/bash</span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">test.sh</span></span><br><span class=\"line\">while getopts &quot;:a:b&quot; opt</span><br><span class=\"line\">do</span><br><span class=\"line\">  case $opt in</span><br><span class=\"line\">    a)</span><br><span class=\"line\">      a=$OPTARG</span><br><span class=\"line\">      echo &quot;a is $a&quot;;;</span><br><span class=\"line\">    b)</span><br><span class=\"line\">      echo &quot;b is set&quot;;;</span><br><span class=\"line\">    ?)</span><br><span class=\"line\">      echo &quot;getopts param error&quot;</span><br><span class=\"line\">      exit 1;;</span><br><span class=\"line\">  esac</span><br><span class=\"line\">done</span><br><span class=\"line\"><span class=\"meta prompt_\"></span></span><br><span class=\"line\"><span class=\"meta prompt_\"># </span><span class=\"language-bash\">./test.sh -b -a 8</span></span><br><span class=\"line\">&quot;:a:b&quot;</span><br><span class=\"line\">最前面的引号：忽略执行错误</span><br><span class=\"line\">a后面引号：表示该标志后有参数</span><br><span class=\"line\">b无引号：表示该标志后无参数</span><br></pre></td></tr></table></figure>\n<h2 id=\"getopts-长参数\"><a href=\"#getopts-长参数\" class=\"headerlink\" title=\"getopts 长参数\"></a>getopts 长参数</h2><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#!/bin/bash</span><br><span class=\"line\"></span><br><span class=\"line\"># Setup getopt.</span><br><span class=\"line\">long_opts=&quot;debug,arg:&quot;</span><br><span class=\"line\">getopt_cmd=$(getopt -o da: --long &quot;$long_opts&quot; \\</span><br><span class=\"line\">            -n $(basename $0) -- &quot;$@&quot;) || \\</span><br><span class=\"line\">            &#123; echo -e &quot;\\nERROR: Getopt failed. Extra args\\n&quot;; exit 1;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">eval set -- &quot;$getopt_cmd&quot;</span><br><span class=\"line\">while true; do</span><br><span class=\"line\">    case &quot;$1&quot; in</span><br><span class=\"line\">        -d|--debug) echo &quot;debug is true&quot;;;</span><br><span class=\"line\">        -a|--arg) echo &quot;arg is $2&quot;;;</span><br><span class=\"line\">        --) shift; break;;</span><br><span class=\"line\">    esac</span><br><span class=\"line\">    shift</span><br><span class=\"line\">done</span><br></pre></td></tr></table></figure>","path":"2022/09/24/shell参数解析/","permalink":"http://chengs.run/2022/09/24/shell%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90/","tags":[{"name":"linux","_id":"cm833960c0002i0q66dwgd8wg","slug":"linux","path":"tags/linux/","permalink":"http://chengs.run/tags/linux/","length":13}],"categories":[],"prev":{"title":"nginx常用配置","date":"2022-10-18T13:39:45.447Z","slug":"nginx常用配置","published":true,"updated":"2022-10-18T13:39:45.447Z","_id":"cm833960y001fi0q62gh985b6","layout":"post","photos":[],"excerpt":"<p>HTTPS、重定向、静态文件、分流</p>","path":"2022/10/18/nginx常用配置/","permalink":"http://chengs.run/2022/10/18/nginx%E5%B8%B8%E7%94%A8%E9%85%8D%E7%BD%AE/","__post":true},"next":{"title":"grep的grouping","date":"2022-09-24T00:14:23.919Z","slug":"grep的grouping","published":true,"updated":"2022-09-24T00:20:02.801Z","_id":"cm833960o000ni0q6dt9dgerr","layout":"post","photos":[],"excerpt":"<p>grep的grouping</p>","path":"2022/09/24/grep的grouping/","permalink":"http://chengs.run/2022/09/24/grep%E7%9A%84grouping/","__post":true},"__post":true}