{"title":"树莓派挂swap、允许docker限制内存","date":"2022-06-27T13:44:28.622Z","source":"_posts/树莓派挂swap、允许docker限制内存.md","raw":"---\ntitle: 树莓派挂swap、允许docker限制内存\ndate: 2022-06-27 21:44:28.622\nupdated: 2022-10-19 20:10:35.712\ncategories: \ntags: \n---\n树莓派挂swap、允许docker限制内存\n<!-- more -->\n修改sudo nano /etc/dphys-swapfile\n\ndocker提示系统不支持cgroup内存限制，需要手动开启。\n解决方案是在/boot/cmdline.txt尾部加入 cgroup_enable=memory cgroup_memory=1后重启\n\ndocker run -d --name nginx2 --memory 1G --memory-swap 1G nginx\ndocker update ubuntu:16.04 --memory-swap -1 -m 512M\n\nsudo docker run -d --name=wxedge --restart=always --privileged --network=macnet --memory-swap -1 -m 1638M --tmpfs /run --tmpfs /tmp -v /media/wxedge_storage:/storage:rw   onething1/wxedge\n\n\n挂载普通swap\n```shell\ndd if=/dev/zero of=/swapfile bs=1M count=4096\nmkswap /swapfile\nswapon /swapfile\necho \"/swapfile swap swap defaults 0 0\" >> /etc/fstab\n```","slug":"树莓派挂swap、允许docker限制内存","published":true,"updated":"2022-10-19T12:10:35.712Z","_id":"cm8339612001wi0q60opa0tp9","comments":true,"layout":"post","photos":[],"html":"<p>树莓派挂swap、允许docker限制内存</p>\n<span id=\"more\"></span>\n<p>修改sudo nano &#x2F;etc&#x2F;dphys-swapfile</p>\n<p>docker提示系统不支持cgroup内存限制，需要手动开启。<br>解决方案是在&#x2F;boot&#x2F;cmdline.txt尾部加入 cgroup_enable&#x3D;memory cgroup_memory&#x3D;1后重启</p>\n<p>docker run -d –name nginx2 –memory 1G –memory-swap 1G nginx<br>docker update ubuntu:16.04 –memory-swap -1 -m 512M</p>\n<p>sudo docker run -d –name&#x3D;wxedge –restart&#x3D;always –privileged –network&#x3D;macnet –memory-swap -1 -m 1638M –tmpfs &#x2F;run –tmpfs &#x2F;tmp -v &#x2F;media&#x2F;wxedge_storage:&#x2F;storage:rw   onething1&#x2F;wxedge</p>\n<p>挂载普通swap</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dd if=/dev/zero of=/swapfile bs=1M count=4096</span><br><span class=\"line\">mkswap /swapfile</span><br><span class=\"line\">swapon /swapfile</span><br><span class=\"line\">echo &quot;/swapfile swap swap defaults 0 0&quot; &gt;&gt; /etc/fstab</span><br></pre></td></tr></table></figure>","excerpt":"<p>树莓派挂swap、允许docker限制内存</p>","more":"<p>修改sudo nano &#x2F;etc&#x2F;dphys-swapfile</p>\n<p>docker提示系统不支持cgroup内存限制，需要手动开启。<br>解决方案是在&#x2F;boot&#x2F;cmdline.txt尾部加入 cgroup_enable&#x3D;memory cgroup_memory&#x3D;1后重启</p>\n<p>docker run -d –name nginx2 –memory 1G –memory-swap 1G nginx<br>docker update ubuntu:16.04 –memory-swap -1 -m 512M</p>\n<p>sudo docker run -d –name&#x3D;wxedge –restart&#x3D;always –privileged –network&#x3D;macnet –memory-swap -1 -m 1638M –tmpfs &#x2F;run –tmpfs &#x2F;tmp -v &#x2F;media&#x2F;wxedge_storage:&#x2F;storage:rw   onething1&#x2F;wxedge</p>\n<p>挂载普通swap</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">dd if=/dev/zero of=/swapfile bs=1M count=4096</span><br><span class=\"line\">mkswap /swapfile</span><br><span class=\"line\">swapon /swapfile</span><br><span class=\"line\">echo &quot;/swapfile swap swap defaults 0 0&quot; &gt;&gt; /etc/fstab</span><br></pre></td></tr></table></figure>","path":"2022/06/27/树莓派挂swap、允许docker限制内存/","permalink":"http://chengs.run/2022/06/27/%E6%A0%91%E8%8E%93%E6%B4%BE%E6%8C%82swap%E3%80%81%E5%85%81%E8%AE%B8docker%E9%99%90%E5%88%B6%E5%86%85%E5%AD%98/","tags":[],"categories":[],"prev":{"title":"广播数据扫描和发送","date":"2022-08-31T05:44:07.360Z","slug":"广播数据扫描和发送","published":true,"updated":"2022-08-31T05:45:42.637Z","_id":"cm8339611001ri0q6etcm5zof","layout":"post","photos":[],"excerpt":"<p>广播数据扫描和发送</p>","path":"2022/08/31/广播数据扫描和发送/","permalink":"http://chengs.run/2022/08/31/%E5%B9%BF%E6%92%AD%E6%95%B0%E6%8D%AE%E6%89%AB%E6%8F%8F%E5%92%8C%E5%8F%91%E9%80%81/","__post":true},"next":{"title":"linux应用开发(3)","date":"2022-06-19T14:32:09.995Z","slug":"linux应用开发(3)","published":true,"updated":"2022-06-19T14:32:27.126Z","_id":"cm833960u0014i0q68psr57r7","layout":"post","photos":[],"excerpt":"<p>Linux应用开发</p>","path":"2022/06/19/linux应用开发(3)/","permalink":"http://chengs.run/2022/06/19/linux%E5%BA%94%E7%94%A8%E5%BC%80%E5%8F%91(3)/","__post":true},"__post":true}